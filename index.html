<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="manifest" href="manifest.json">
  <meta charset="utf-8"/>
  <title>Seed Cart Tank Split Calculator</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      background-color: #f2f2f2;
      color: #222;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 1rem;
    }

    .container {
      background: white;
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      width: 100%;
      max-width: 450px;
      box-sizing: border-box;
    }

    h1 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      text-align: center;
      color: #111;
    }

    label {
      font-size: 1rem;
      font-weight: 600;
      margin: 0.75rem 0 0.25rem;
      display: block;
      text-align: left;
    }

    select, input[type="text"], input[type="number"] {
      width: 100%;
      padding: 0.6rem;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 1rem;
      box-sizing: border-box;
    }

    .tank-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 0.75rem;
    }

    .tank-row label {
      margin: 0;
      font-weight: 500;
      flex-grow: 1;
    }

    .tank-row input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-left: 1rem;
    }

    button {
      width: 100%;
      margin-top: 1.5rem;
      padding: 0.75rem;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #388e3c;
    }

    .result {
      margin-top: 1.25rem;
      font-size: 1rem;
      font-weight: 500;
      color: #222;
      text-align: left;
      white-space: pre-line;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Seed Cart Tank Split Calculator</h1>
    <label for="make">Make:</label>
    <select id="make"></select>
    <label for="model">Model:</label>
    <select id="model"></select>
    <div id="tanks"></div>
    <div class="result" id="output"></div>
  </div>

  <script>
    const data = { "Case": { "ADX2180": [66.0, 114.0, 0.0, 0.0] } }; // Placeholder for brevity

    const makeSelect = document.getElementById('make');
    const modelSelect = document.getElementById('model');
    const tanksDiv = document.getElementById('tanks');
    const output = document.getElementById('output');

    const backgroundColors = {
      "John Deere": "#367C2B",
      "Case": "#D0002D",
      "Horsch": "#808080",
      "Vaderstad": "#EE251B",
      "Seedmaster": "#E1AD01",
      "Bourgault": "#D3D3D3"
    };

    Object.keys(data).forEach(make => {
      const opt = document.createElement('option');
      opt.value = make;
      opt.textContent = make;
      makeSelect.appendChild(opt);
    });

    makeSelect.addEventListener('change', () => {
      document.body.style.backgroundColor = backgroundColors[makeSelect.value] || "#ffffff";
      modelSelect.innerHTML = '';
      const models = data[makeSelect.value];
      Object.keys(models).forEach(model => {
        const opt = document.createElement('option');
        opt.value = model;
        opt.textContent = model;
        modelSelect.appendChild(opt);
      });
      updateTanks();
    });

    modelSelect.addEventListener('change', updateTanks);

    function updateTanks() {
      tanksDiv.innerHTML = '';
      output.innerHTML = '';
      const capacities = data[makeSelect.value][modelSelect.value];

      capacities.forEach((cap, i) => {
        if (cap > 0) {
          const id = `tank${i+1}`;
          const row = document.createElement('div');
          row.className = 'tank-row';

          const label = document.createElement('label');
          label.htmlFor = id;
          label.textContent = `Tank ${i+1} (${cap} bu)`;

          const checkbox = document.createElement('input');
          checkbox.type = 'checkbox';
          checkbox.id = id;
          checkbox.dataset.cap = cap;
          checkbox.addEventListener('change', calculate);

          row.appendChild(label);
          row.appendChild(checkbox);
          tanksDiv.appendChild(row);
        }
      });
    }

    function calculate() {
      const selected = [...tanksDiv.querySelectorAll('input:checked')];
      const caps = selected.map(cb => parseFloat(cb.dataset.cap));
      const total = caps.reduce((a, b) => a + b, 0);

      if (total === 0) {
        output.textContent = '';
        return;
      }

      const ratios = caps.map(c => (c / total).toFixed(2));
      output.innerHTML = `
        <p>Total Selected Capacity: <strong>${total.toFixed(2)} bu</strong></p>
        <p>Suggested Mix Ratios:</p>
        <ul>
          ${ratios.map((r, i) => `<li>Tank ${i+1}: ${r}</li>`).join('')}
        </ul>
      `;
    }

    makeSelect.dispatchEvent(new Event('change'));
  </script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./service-worker.js');
    }
  </script>
</body>
</html>
